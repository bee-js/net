!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.net=t()}(this,function(){"use strict";function e(e){return"[object Object]"===Object.prototype.toString.call(e)}function t(e){return u[Object.prototype.toString.call(e)]}function n(e,t,n){Object.defineProperty(e,t,{writable:!1,value:n})}function s(e,t){var s=e.status,o=e.getResponseHeader("Content-Type"),r=e.responseText,i=d.length,a=void 0,u=this;for(1223===s&&(s=204),o=(o||"").split(";")[0],this.xhr=e,this.request=t,n(u,"status",s),n(u,"statusType",d[s/100|0]),n(u,"statusText",e.statusText);a=d[--i];)n(this,a,a==this.statusType);n(u,"error",this.clientError||this.serverError),u._parseHeaders(e.getAllResponseHeaders()),n(u,"contentType",o),n(u,"type",t.options.responseType||p[o]),n(u,"text",r),""!=e.responseType&&c[e.responseType]?(n(u,e.responseType,e.response),n(u,"body",e.response)):u._parseResponseBody()}function o(e,t,n){this.method=e.toUpperCase(),this.path=t,this.data={},this.form=null,this.options=Object.create(r.defaultOptions),this.headers={}}var r={},i=window,a={},p={},c={arraybuffer:!0,blob:!0,document:!0,text:!0},u={"[object ArrayBuffer]":!0,"[object Blob]":!0,"[object File]":!0},d=[null,"info","success","redirect","clientError","serverError"],f=/\r?\n/;return r.Promise="Promise"in i?i.Promise:null,r.defaultOptions={async:!0,type:"urlencoded"},r.serializeObject=function(t){if(!e(t))return t;var n=[];for(var s in t){var o=void 0==t[s]?!0:t[s];n.push(encodeURIComponent(s)+"="+encodeURIComponent(o))}return n.join("&")},r.setHandler=function(t,n){var s={};return"string"==typeof n?s.contentTypes=[n]:Array.isArray(n)&&(s.contentTypes=n),e(t)?Object.assign(s,t):(s.name=t,Object.assign(s,n)),s.contentTypes.forEach(function(e){p[e]=t}),a[t]=s,t},r.setHandler("html","text/html"),r.setHandler("urlencoded",{contentTypes:["application/x-www-form-urlencoded"],setter:r.serializeObject}),r.setHandler("json",{contentTypes:["application/json"],getter:JSON.parse,setter:JSON.stringify}),s.prototype={getHeader:function(e){return this._headers[e.toLowerCase()]},_parseHeaders:function(e){var t=e.split(f),s={},o={},r=t.length-1,i=0;for(t.pop();r>i;){var a=t[i++],p=a.split(":"),c=p.shift(),u=p.join(":").trim();s[c]=u,o[c.toLowerCase()]=u}n(this,"headers",s),n(this,"_headers",o)},_parseResponseBody:function(){var e=this.type,t=a[e],s=this.text;if(e&&t&&t.getter)try{s=t.getter.call(s,s),n(this,e,s)}catch(o){}n(this,"body",s)}},o.prototype={set:function(n,s){return void 0===s?e(n)?Object.assign(this.data,n):this.form=n:(t(s)&&(this.form=this.form||new FormData),this.data[n]=s),this},setHeader:function(t,n){return void 0===n&&e(t)?Object.assign(this.headers,t):this.headers[t]=n,this},setOption:function(e,t){return this.options[e]=t,this},async:function(e){return this.setOption("async",e)},timeout:function(e){return this.setOption("timeout",e)},type:function(e){return this.setOption("type",e)},expect:function(e){return this.setOption("responseType",e)},send:function(){var e=new i.XMLHttpRequest,t=this,n=t.options.type,o=t.path,p=t.options.responseType,u=a[n],d=Object.create(t.headers),f=void 0;if(~n.indexOf("/")&&(d["Content-Type"]=n),Object.keys(t.data).length>0||t.form){if("GET"===t.method){f=null;var h=r.serializeObject(t.data);""!==h&&(o+=~o.indexOf("?")?"&"+h:"?"+h)}else if(t.form){if(f=t.form,f instanceof FormData)for(var l in t.data)f.append(l,f)}else f=u&&u.setter?u.setter.call(t.data,t.data):t.data;!u||"Content-Type"in d||(d["Content-Type"]=u.contentTypes[0])}e.open(t.method,o,t.options.async),p&&c[p]&&(e.responseType=p);for(var y in d)e.setRequestHeader(y,d[y]);return new r.Promise(function(n,o){e.addEventListener("load",function(){var o=new s(e,t);n(o)}),e.addEventListener("error",function(){o(e)}),t.options.timeout&&(e.timeout=t.options.timeout,e.addEventListener("timeout",function(){o(e)})),e.send(f)})}},r.Request=o,r.Response=s,r});
//# sourceMappingURL=net.min.js.map
