!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.net=t()}(this,function(){"use strict";function e(e){return"[object Object]"===Object.prototype.toString.call(e)}function t(e){return c[Object.prototype.toString.call(e)]}function n(e,t,n){Object.defineProperty(e,t,{writable:!1,value:n})}function r(e,t){var r=e.status,s=e.getResponseHeader("Content-Type"),o=e.responseText,i=d.length,a=void 0,c=this;for(1223===r&&(r=204),s=(s||"").split(";")[0],this.xhr=e,this.request=t,n(c,"status",r),n(c,"statusType",d[r/100|0]),n(c,"statusText",e.statusText);a=d[--i];)n(this,a,a==this.statusType);n(c,"error",this.clientError||this.serverError),c._parseHeaders(e.getAllResponseHeaders()),n(c,"contentType",s),n(c,"type",t.options.responseType||p[s]),n(c,"text",o),""!=e.responseType&&u[e.responseType]?(n(c,e.responseType,e.response),n(c,"body",e.response)):c._parseResponseBody()}function s(e,t,n){var r=this;this.method=e.toUpperCase(),this.path=t,this.data={},this.form=null,this.options=Object.create(o.defaultOptions),this.headers={},this.urlParams={},this.urlData={},~t.indexOf("{")&&t.replace(/{(\w+)}/g,function(e,t){r.urlParams[t]=e})}var o={},i=window,a={},p={},u={arraybuffer:!0,blob:!0,document:!0,text:!0},c={"[object ArrayBuffer]":!0,"[object Blob]":!0,"[object File]":!0},d=[null,"info","success","redirect","clientError","serverError"],f=/\r?\n/;return o.Promise="Promise"in i?i.Promise:null,o.defaultOptions={async:!0,type:"urlencoded"},o.serializeObject=function(t){if(!e(t))return t;var n=[];for(var r in t){var s=void 0==t[r]?!0:t[r];n.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}return n.join("&")},o.setHandler=function(t,n){var r={};return"string"==typeof n?r.contentTypes=[n]:Array.isArray(n)&&(r.contentTypes=n),e(t)?Object.assign(r,t):(r.name=t,Object.assign(r,n)),r.contentTypes.forEach(function(e){p[e]=t}),a[t]=r,t},o.setHandler("html","text/html"),o.setHandler("urlencoded",{contentTypes:["application/x-www-form-urlencoded"],setter:o.serializeObject}),o.setHandler("json",{contentTypes:["application/json"],getter:JSON.parse,setter:JSON.stringify}),r.prototype={getHeader:function(e){return this._headers[e.toLowerCase()]},_parseHeaders:function(e){var t=e.split(f),r={},s={},o=t.length-1,i=0;for(t.pop();o>i;){var a=t[i++],p=a.split(":"),u=p.shift(),c=p.join(":").trim();r[u]=c,s[u.toLowerCase()]=c}n(this,"headers",r),n(this,"_headers",s)},_parseResponseBody:function(){var e=this.type,t=a[e],r=this.text;if(e&&t&&t.getter)try{r=t.getter.call(r,r),n(this,e,r)}catch(s){}n(this,"body",r)}},s.prototype={set:function(n,r){if(void 0===r)if(e(n))for(var s in n)s in this.urlParams?this.urlData[s]=n[s]:this.data[s]=n[s];else this.form=n;else t(r)&&(this.form=this.form||new FormData),n in this.urlParams?this.urlData[n]=r:this.data[n]=r;return this},setHeader:function(t,n){return void 0===n&&e(t)?Object.assign(this.headers,t):this.headers[t]=n,this},setOption:function(e,t){return this.options[e]=t,this},async:function(e){return this.setOption("async",e)},timeout:function(e){return this.setOption("timeout",e)},type:function(e){return this.setOption("type",e)},expect:function(e){return this.setOption("responseType",e)},send:function(){var e=new i.XMLHttpRequest,t=this,n=t.options.type,s=t.path,p=t.options.responseType,c=a[n],d=Object.create(t.headers),f=void 0;for(var h in t.urlParams)s=s.replace(t.urlParams[h],t.urlData[h]);if(~n.indexOf("/")&&(d["Content-Type"]=n),Object.keys(t.data).length>0||t.form){if("GET"===t.method){f=null;var l=o.serializeObject(t.data);""!==l&&(s+=~s.indexOf("?")?"&"+l:"?"+l)}else if(t.form){if(f=t.form,f instanceof FormData)for(var h in t.data)f.append(h,f)}else f=c&&c.setter?c.setter.call(t.data,t.data):t.data;!c||"Content-Type"in d||(d["Content-Type"]=c.contentTypes[0])}e.open(t.method,s,t.options.async),p&&u[p]&&(e.responseType=p);for(var y in d)e.setRequestHeader(y,d[y]);return new o.Promise(function(n,s){e.addEventListener("load",function(){var s=new r(e,t);n(s)}),e.addEventListener("error",function(){s(e)}),t.options.timeout&&(e.timeout=t.options.timeout,e.addEventListener("timeout",function(){s(e)})),e.send(f)})}},o.Request=s,o.Response=r,o});
//# sourceMappingURL=net.min.js.map
