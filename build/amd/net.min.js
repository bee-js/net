define(function(){"use strict";function t(t){return t===Object(t)}function e(t,e){var s=t.status,n=t.getResponseHeader("Content-Type"),r=t.responseText;1223===s&&(s=204),n=(n||"").split(";")[0],this.info=!1,this.success=!1,this.redirect=!1,this.clientError=!1,this.serverError=!1,this.xhr=t,this.request=e,this.status=s,this.statusType=p[s/100|0],this.statusText=t.statusText,this[this.statusType]=!0,this.error=this.clientError||this.serverError,this._parseHeaders(t.getAllResponseHeaders()),this.contentType=n,this.type=o[n],this.text=r,""!=t.responseType&&a[t.responseType]?this[t.responseType]=this.body=t.response:this._parseResponseBody()}function s(t,e,s){this.method=t.toUpperCase(),this.path=e,this.data={},this.form=null,this.options=Object.create(n.defaultOptions),this.headers={}}var n={},r=window,i={},o={},a={arraybuffer:!0,blob:!0,document:!0,text:!0},p=[null,"info","success","redirect","clientError","serverError"],h=/\r?\n/;return n.Promise="Promise"in r?r.Promise:null,n.defaultOptions={async:!0,type:"urlencoded"},n.serializeObject=function(e){if(!t(e))return e;var s=[];for(var n in e){var r=void 0==e[n]?!0:e[n];s.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}return s.join("&")},n.setHandler=function(e,s){var n={};return"string"==typeof s?n.contentTypes=[s]:Array.isArray(s)&&(n.contentTypes=s),t(e)?Object.assign(n,e):(n.name=e,Object.assign(n,s)),n.contentTypes.forEach(function(t){o[t]=e}),i[e]=n,e},n.setHandler("html","text/html"),n.setHandler("urlencoded",{contentTypes:["application/x-www-form-urlencoded"],setter:n.serializeObject}),n.setHandler("json",{contentTypes:["application/json"],getter:JSON.parse,setter:JSON.stringify}),e.prototype={getHeader:function(t){return this._headers[t.toLowerCase()]},_parseHeaders:function(t){var e=t.split(h),s={},n={},r=e.length-1,i=0;for(e.pop();r>i;){var o=e[i++],a=o.split(":"),p=a.shift(),c=a.join(":").trim();s[p]=c,n[p.toLowerCase()]=c}this.headers=s,this._headers=n},_parseResponseBody:function(){var t=o[this.contentType],e=i[this.type],s=this.text;if(t&&e&&e.getter)try{this[t]=this.body=e.getter.call(s,s)}catch(n){this.body=s}else this.body=s}},s.prototype={set:function(e,s){return e instanceof FormData?this.form=e:void 0===s?t(e)?Object.assign(this.data,e):this.data[e]=!0:this.data[e]=s,this},setHeader:function(e,s){return void 0===s&&t(e)?Object.assign(this.headers,e):this.headers[e]=s,this},setOption:function(t,e){return this.options[t]=e,this},async:function(t){return this.setOption("async",t)},timeout:function(t){return this.setOption("timeout",t)},type:function(t){return this.setOption("type",t)},send:function(){var t=new r.XMLHttpRequest,s=this,o=s.options.type,p=s.path,h=s.options.responseType,c=i[o],d=Object.create(s.headers),u=void 0;if(Object.keys(s.data).length>0||s.form)if("GET"===s.method){u=null;var f=n.serializeObject(s.data);""!==f&&(p+=~p.indexOf("?")?"&"+f:"?"+f)}else if(s.form){u=s.form;for(var l in s.data)u.append(l,u)}else c&&c.setter?(u=c.setter.call(s.data,s.data),"Content-Type"in d||(d["Content-Type"]=c.contentTypes[0])):u=s.data;t.open(s.method,p,s.options.async),h&&a[h]&&(t.responseType=h);for(var y in d)t.setRequestHeader(y,d[y]);return new n.Promise(function(n,r){t.addEventListener("load",function(){var r=new e(t,s);n(r)}),t.addEventListener("error",function(){r(t)}),s.options.timeout&&(t.timeout=s.options.timeout,t.addEventListener("timeout",function(){r(t)})),t.send(u)})}},n.Request=s,n.Response=e,n});
//# sourceMappingURL=net.min.js.map
