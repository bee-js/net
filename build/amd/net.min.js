define(function(){"use strict";function e(e){return"[object Object]"===Object.prototype.toString.call(e)}function t(e){return c[Object.prototype.toString.call(e)]}function r(e,t,r){Object.defineProperty(e,t,{writable:!1,value:r})}function n(e,t){var n=e.status,s=e.getResponseHeader("Content-Type"),o=e.responseText,i=d.length,a=void 0,c=this;for(1223===n&&(n=204),s=(s||"").split(";")[0],this.xhr=e,this.request=t,r(c,"status",n),r(c,"statusType",d[n/100|0]),r(c,"statusText",e.statusText);a=d[--i];)r(this,a,a==this.statusType);r(c,"error",this.clientError||this.serverError),c._parseHeaders(e.getAllResponseHeaders()),r(c,"contentType",s),r(c,"type",t.options.responseType||p[s]),r(c,"text",o),""!=e.responseType&&u[e.responseType]?(r(c,e.responseType,e.response),r(c,"body",e.response)):c._parseResponseBody()}function s(e,t,r){var n=this;this.method=e.toUpperCase(),this.path=t,this.data={},this.form=null,this.options=Object.create(o.defaultOptions),this.headers={},this.urlParams={},this.urlData={},~t.indexOf("{")&&t.replace(/{(\w+)}/g,function(e,t){n.urlParams[t]=e})}var o={},i=window,a={},p={},u={arraybuffer:!0,blob:!0,document:!0,text:!0},c={"[object ArrayBuffer]":!0,"[object Blob]":!0,"[object File]":!0},d=[null,"info","success","redirect","clientError","serverError"],f=/\r?\n/;return o.Promise="Promise"in i?i.Promise:null,o.defaultOptions={async:!0,type:"urlencoded"},o.serializeObject=function(t){if(!e(t))return t;var r=[];for(var n in t){var s=void 0==t[n]?!0:t[n];r.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}return r.join("&")},o.setHandler=function(t,r){var n={};return"string"==typeof r?n.contentTypes=[r]:Array.isArray(r)&&(n.contentTypes=r),e(t)?Object.assign(n,t):(n.name=t,Object.assign(n,r)),n.contentTypes.forEach(function(e){p[e]=t}),a[t]=n,t},o.setHandler("html","text/html"),o.setHandler("urlencoded",{contentTypes:["application/x-www-form-urlencoded"],setter:o.serializeObject}),o.setHandler("json",{contentTypes:["application/json"],getter:JSON.parse,setter:JSON.stringify}),n.prototype={getHeader:function(e){return this._headers[e.toLowerCase()]},_parseHeaders:function(e){var t=e.split(f),n={},s={},o=t.length-1,i=0;for(t.pop();o>i;){var a=t[i++],p=a.split(":"),u=p.shift(),c=p.join(":").trim();n[u]=c,s[u.toLowerCase()]=c}r(this,"headers",n),r(this,"_headers",s)},_parseResponseBody:function(){var e=this.type,t=a[e],n=this.text;if(e&&t&&t.getter)try{n=t.getter.call(n,n),r(this,e,n)}catch(s){}r(this,"body",n)}},s.prototype={set:function(r,n){if(void 0===n)if(e(r))for(var s in r)s in this.urlParams?this.urlData[s]=r[s]:this.data[s]=r[s];else this.form=r;else t(n)&&(this.form=this.form||new FormData),r in this.urlParams?this.urlData[r]=n:this.data[r]=n;return this},setHeader:function(t,r){return void 0===r&&e(t)?Object.assign(this.headers,t):this.headers[t]=r,this},setOption:function(e,t){return this.options[e]=t,this},async:function(e){return this.setOption("async",e)},timeout:function(e){return this.setOption("timeout",e)},type:function(e){return this.setOption("type",e)},expect:function(e){return this.setOption("responseType",e)},send:function(){var e=new i.XMLHttpRequest,t=this,r=t.options.type,s=t.path,p=t.options.responseType,c=a[r],d=Object.create(t.headers),f=void 0;for(var h in t.urlParams)s=s.replace(t.urlParams[h],t.urlData[h]);if(~r.indexOf("/")&&(d["Content-Type"]=r),Object.keys(t.data).length>0||t.form){if("GET"===t.method){f=null;var l=o.serializeObject(t.data);""!==l&&(s+=~s.indexOf("?")?"&"+l:"?"+l)}else if(t.form){if(f=t.form,f instanceof FormData)for(var h in t.data)f.append(h,f)}else f=c&&c.setter?c.setter.call(t.data,t.data):t.data;!c||"Content-Type"in d||(d["Content-Type"]=c.contentTypes[0])}e.open(t.method,s,t.options.async),p&&u[p]&&(e.responseType=p);for(var y in d)e.setRequestHeader(y,d[y]);return new o.Promise(function(r,s){e.addEventListener("load",function(){var s=new n(e,t);r(s)}),e.addEventListener("error",function(){s(e)}),t.options.timeout&&(e.timeout=t.options.timeout,e.addEventListener("timeout",function(){s(e)})),e.send(f)})}},o.Request=s,o.Response=n,o});
//# sourceMappingURL=net.min.js.map
